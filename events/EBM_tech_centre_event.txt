add_namespace = EBMTC
add_namespace = EBMTC_M

# TODO
# Create a diverse event chain for the Tech Centre
# 3 events for civilian focus
# 3 events for military focus
# 8 events for espionage focus
# Create random events from incidents on the building

# First Event
country_event = {
	
	id = EBMTC.1
	title = EBMTC.1.t
	desc = EBMTC.1.d

	mean_time_to_happen = {
		months = 1
	}

	trigger = {
		tech_centre > 0
		NOT = {
			has_idea = EBM_tech_centre_idea_built
		}
		
	}
 
	option = {
		name = EBMTC.1.a
		swap_ideas = {
			remove_idea = EBM_tech_centre_idea_behind
			add_idea = EBM_tech_centre_idea_built
		}		
		hidden_effect = {
			every_other_country = {
				if = {
					limit = {
						NOT = {
							has_idea = EBM_tech_centre_idea_built
						}
					}
					news_event = EBMTC.2
				}
				else = {
					news_event = EBMTC.3
				}
			}
		}
	}	
}

news_event = {
	id = EBMTC.2
	title = EBMTC.2.t
	desc = EBMTC.2.d

	is_triggered_only = yes

	option = {
		name = EBMTC.2.a
		hidden_effect = {
			if = {
				limit = {
					NOT = {
						has_idea = EBM_tech_centre_idea_behind
					}
				}
				add_ideas = EBM_tech_centre_idea_behind	
			}
			
		}
	}
	
}

news_event = {
	id = EBMTC.3
	title = EBMTC.2.t
	desc = EBMTC.2.d

	is_triggered_only = yes

	option = {
		name = EBMTC.3.a
		hidden_effect = {
			add_stability = 0.01
			add_war_support = -0.1
		}
	}
	
}

# Second Event - Focus Selection
country_event = {
	
	id = EBMTC.4
	title = EBMTC.4.t
	desc = EBMTC.4.d
	
	mean_time_to_happen = {
		months = 3	
	}

	trigger = {
		date > 1940.1.1
		has_idea = EBM_tech_centre_idea_built
		NOT = {
			has_idea = EBM_tech_centre_idea_civ_focus
			has_idea = EBM_tech_centre_idea_milOrg_focus
			has_idea = EBM_tech_centre_idea_milProd_focus
			has_idea = EBM_tech_centre_idea_spy_focus
		}
	}

	option = {
		
		name = EBMTC.4.a
		hidden_effect = {
			set_variable = {
				var = tech_centre_focus
				value = 1
			}
			add_ideas = EBM_tech_centre_idea_civ_focus
		}
	}

	option = {
		name = EBMTC.4.b
		hidden_effect = {
			set_variable = {
				var = tech_centre_focus
				value = 2
			}
		}
	}

	option = {
		name = EBMTC.4.c
		hidden_effect = {
			set_variable = {
				var = tech_centre_focus
				value = 3
			}
			add_ideas = EBM_tech_centre_idea_spy_focus
		}
	}

}

# CIVILIAN EVENTS

country_event = {
	
	id = EBMTC.5
	title = EBMTC.5.t
	desc = EBMTC.5.d

	mean_time_to_happen = {
		months = 6
	}

	trigger = {
		date > 1942.1.1
		AND = {
			check_variable = {
				var = tech_centre_focus
				value = 1
				compare = equals
			}
			has_idea = EBM_tech_centre_idea_civ_focus
		}
	}

	option = {
		name = EBMTC.5.a
		swap_ideas = {
			remove_idea = EBM_tech_centre_idea_civ_focus
			add_idea = EBM_tech_centre_idea_civ2_focus
		}
		hidden_effect = {
			set_variable = {
				var = tech_centre_focus_level
				value = 2
			}
		}
	}
}

country_event = {
	
	id = EBMTC.6
	title = EBMTC.6.t
	desc = EBMTC.6.d

	mean_time_to_happen = {
		months = 6
	}

	trigger = {
		date > 1944.1.1
		AND = {
			check_variable = {
				var = tech_centre_focus
				value = 1
				compare = equals
			}
			check_variable = {
				var = tech_centre_focus_level
				value = 2
				compare = equals
			}
			has_idea = EBM_tech_centre_idea_civ2_focus			
		}
	}

	option = {
		name = EBMTC.6.a
		swap_ideas = {
			remove_idea = EBM_tech_centre_idea_civ2_focus
			add_idea = EBM_tech_centre_idea_civ3a_focus
		}
		hidden_effect = {
			set_variable = {
				var = tech_centre_focus_level
				value = 3
			}
		}
	}

	option = {
		name = EBMTC.6.b
		swap_ideas = {
			remove_idea = EBM_tech_centre_idea_civ2_focus
			add_idea = EBM_tech_centre_idea_civ3b_focus
		}
		hidden_effect = {
			set_variable = {
				var = tech_centre_focus_level
				value = 3
			}
			set_variable = {
				var = tech_centre_focus_target
				value = 1
				# This is only for civilian targeted focus
			}
		}
	}
}

# CIVILIAN CENTRALIZED PRODUCTION EVENT CHAIN
# This can be very unbalanced with some mods, we need to focus on balancing after few matches in MP.

country_event = {

	id = EBMTC.7
	title = EBMTC.7.t
	desc = EBMTC.7.d

	mean_time_to_happen = {
		months = 6
	}

	trigger = {
		date > 1946.1.1
		AND = {
			check_variable = {
				var = tech_centre_focus
				value = 1
				compare = equals
			}
			check_variable = {
				var = tech_centre_focus_level
				value = 3
				compare = equals
			}
			has_idea = EBM_tech_centre_idea_civ3a_focus
		}
	}

	option = {
		name = EBMTC.7.a
		hidden_effect = {
			add_stability = -0.25
			swap_ideas = {
				remove_idea = EBM_tech_centre_idea_civ3a_focus
				add_idea = EBM_tech_centre_idea_civ4a_focus
			}
			set_variable = {
				var = tech_centre_focus_level
				value = 4
			}
			every_country = {
				if = {
					limit = {
						has_idea = EBM_tech_centre_idea_civ4a_focus
						check_variable = {
							var = tech_centre_focus_level
							value = 4
							compare = equals
						}
					}	
					news_event = EBMTC.8
				}
				else = {
					news_event = EBMTC.9
				}
			}
		}
	}
}

news_event = {
	id = EBMTC.8
	title = EBMTC.8.t
	desc = EBMTC.8.d

	is_triggered_only = yes

	option = {
		name = EBMTC.8.a
		hidden_effect = {
			add_ideas = EBM_tech_centre_idea_civ_unrest
		}
	}
	
}

news_event = {
	id = EBMTC.9
	title = EBMTC.8.t
	desc = EBMTC.8.d

	is_triggered_only = yes

	option = {
		name = EBMTC.9.a
		hidden_effect = {
			add_war_support = 0.05
		}
	}
	
}

# CIVILIAN FOCUSED DEVELOPMENT EVENT CHAIN
# This can be very unbalanced event for the SP.
# Try create some conditions to archive the OP idea

country_event = {
	
	id = EBMTC.10
	title = EBMTC.10.t
	desc = EBMTC.10.d

	mean_time_to_happen = {
		months = 6
	}

	trigger = {
		date > 1946.1.1
		AND = {
			has_idea = EBM_tech_centre_idea_civ3b_focus
			check_variable = {
				var = tech_centre_focus_level
				value = 3
				compare = equals
			}
			check_variable = {
				var = tech_centre_focus_target
				value = 1
				compare = equals
			}
		}
	}

	option = {
		name = EBMTC.10.a
		swap_ideas = {
			remove_idea = EBM_tech_centre_idea_civ3b_focus
			add_idea = EBM_tech_centre_idea_civ4b_focus
		}
		hidden_effect = {
			every_other_country = {
				news_event = EBMTC.11
			}
		}
	}
}

news_event = {

	id = EBMTC.11
	title = EBMTC.11.t
	desc = EBMTC.11.d

	is_triggered_only = yes

	option = {
		name = EBMTC.11.a
		hidden_effect = {
			add_stability = 0.01
		}
	}
}

# MILITARY FOCUSED EVENTS.
# Primary events for the Military Focus

country_event = {

	id = EBMTC_M.1
	title = EBMTC_M.1.t
	desc = EBMTC_M.1.d

	mean_time_to_happen = {
		days = 30
	}

	trigger = {
		check_variable = {
			var = tech_centre_focus_level
			value = 2
			compare = equals
		}
	}

	option = {
		name = EBMTC_M.1.a
		add_ideas = EBM_tech_centre_idea_milOrg_focus
		set_variable = {
			var = tech_centre_mil_focus
			value = 1
		}
	}

	option = {
		name = EBMTC_M.1.b
		add_ideas = EBM_tech_centre_idea_milProd_focus
		set_variable = {
			var = tech_centre_mil_focus
			value = 2
		}
	}

}

#Organization Event chain

country_event = {

	id = EBMTC_M.2
	title = EBMTC_M.2.t
	desc = EBMTC_M.2.d

	mean_time_to_happen = {
		days = 30
	}

	trigger = {
		check_variable = {
			var = tech_centre_mil_focus
			value = 1
			compare = equals
		}
		has_idea = EBM_tech_centre_idea_milOrg_focus
	}

	option = {
		name = EBMTC_M.2.a
		hidden_effect = {
			country_event = EBMTC_M.201
		}
	}
}

country_event = {
	id = EBMTC_M.201
	title = "Choosing Military Approach"
	desc = "Choosing Military Approach"

	mean_time_to_happen = {
		days = 90
	}

	is_triggered_only = yes
	fire_for_sender = no

	trigger = {
		has_idea = EBM_tech_centre_idea_milOrg_focus
	}

	option = {
		name = "Democratic Intervention"
		ai_chance = {
			base = 30
			modifier = {
				is_in_faction = yes
				add = 10
			}

			modifier = {
				democratic > 0.1
				add = 10
			}

			factor = 0.25
		}
		swap_ideas = {
			remove_idea = EBM_tech_centre_idea_milOrg_focus
			add_idea = EBM_tech_centre_idea_milOrgDem_focus
		}
	}

	option = {
		name = "Fascism Intervention"
		ai_chance = {
			base = 30
			modifier = {
				is_in_faction = yes
				add = 10
			}

			modifier = {
				fascism > 0.1
				add = 10
			}

			factor = 0.25
		}
		swap_ideas = {
			remove_idea = EBM_tech_centre_idea_milOrg_focus
			add_idea = EBM_tech_centre_idea_milOrgFas_focus
		}
	}

	option = {
		name = "Communism Intervention"
		ai_chance = {
			base = 30
			modifier = {
				is_in_faction = yes
				add = 10
			}

			modifier = {
				communism > 0.1
				add = 10
			}

			factor = 0.25
		}
		swap_ideas = {
			remove_idea = EBM_tech_centre_idea_milOrg_focus
			add_idea = EBM_tech_centre_idea_milOrgCom_focus
		}
	}

	option = {
		name = "Balanced Approach"
		ai_chance = {
			base = 30
			modifier = {
				is_in_faction = yes
				add = 10
			}

			modifier = {
				neutrality > 0.1
				add = 20
			}

			factor = 0.25
		}
		swap_ideas = {
			remove_idea = EBM_tech_centre_idea_milOrg_focus
			add_idea = EBM_tech_centre_idea_milOrgNeu_focus
		}
	}
}




